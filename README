--------------------------------------------------------------------------------
ThunderSync, a Mozilla Thunderbird v3 extension
$Id$
--------------------------------------------------------------------------------

Copyright (C) 2011 Frank Abelbeck <frank.abelbeck@googlemail.com>

This file is part of the Mozilla Thunderbird extension "ThunderSync."

ThunderSync is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

ThunderSync is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with ThunderSync; if not, write to the Free Software
Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
or see <http://www.gnu.org/licenses/>.

--------------------------------------------------------------------------------

Author.....: Frank Abelbeck
Supporters.: Lucas Treffenstädt (testing, code contribution auto-start),
             Yair Lanz (feedback regarding charsets)
Version....: 2011-02-18 (1.2)
Licence....: GNU General Public License version 2

Description: Allows to synchronise Thunderbird's addressbook with external
             directories/files. Right now, only vCard version 2.1 is
             supported as export file format.
             
             Most information of Thunderbird's addressbook is translated into
             the vCard format. Untranslatable stuff is coded as
             X-MOZILLA-PROPERTY:PropertyName;PropertyValue.
             
             Yes, this extension processes your contact images! That was the
             point of this extension! I wanted nice pictures of the people
             calling me.

Disclaimer.: I created this extension to solve the sync problem with my phone.
             ThunderSync is distributed in the hope that it will help other
             people with similar problems. This extension does access your
             Thunderbird addressbook, so please be cautious! I seek perfection,
             but I cannot verify the extension's behaviour due to the
             overwhelming number of possible platform configurations.

--------------------------------------------------------------------------------

Quick Start Guide #1: Post installation

Open the extension's properties dialog and you will see a list of your
addressbooks. Right-click on one of these entries and select the action
"choose path." A directory selection dialog window will open and you will be
able to select and/or create a target directory for the selected addressbook.
Future synchronisation operations will use this directory for file storage.

Prior to closing this dialog make sure that vCard is selected as file format.
Of course, at the moment this is the only format you can choose. Perhaps
more will follow in future times...

Starting with Version 1.1 the file encoding für vCards can be chosen. This tries
to tackle a problem with third-party programs like Outlook which ignore parts of
the vCard standard.

Version 1.2 added another option. Now you can choose whether ThunderSync is
executed when Thunderbird is starting.

--------------------------------------------------------------------------------

Quick Start Guide #1: Usage

If at least one addressbook is mapped to a directory it will be possible to
do a proper synchronisation. Open Thunderbird's addressbook and choose menu
item
          Extras -> Synchronise addressbook...

A new dialog will pop up. After a click on the "compare" button a list of
differences between your local addressbook and the external file ressources will
be built. If both ressources equal, a dialog will inform you about this.

Otherwise a table will show the differences, with the middle column displaying
the type of difference:

    !=    contact/property on both sides, with different content
    <>    contact/property on both sides, conflict resolved (see below)
    >>    copy contact/property from left to right (i.e. local to external)
    <<    copy contact/property from right to left (i.e. external to local)

If at least one '!=' is present, you will not be allowed to start a
synchronisation. You have to resolve the conflict by opening the contact in
question. Simply click on it, this will show all differing properties. Find any
property with a '!=' and double-click on it. A double click toggles between
keeping local information or using the external ressource.

When no '!=' is left in the list of differing contacts, the "syncronise" button
will be enabled and you can trigger the synchronisation process.

--------------------------------------------------------------------------------

Changelog:

1.0 (2010-12-17)
   - initial release

1.1 (2011-01-12)
   - preferences storage names changed to Mozilla policy
   - added support for various charsets (thanks to Yair Lanz for feedback)
   - vCard file processing improvements

1.2 (2011-02-18)
   - added option for automatic execution at start (thanks to Lucas Treffenstädt)
   - changed behaviour: contacts are compared when ThunderSync dialog is opened
   - internal code revision: contact identification base on unique identifier (UID)
        - any other property can be changed
	- multiple contacts with same name (e.g. John Smith) are allowed as long
          as they differ in at least one property
   - filenames: new files will be named using the UID
